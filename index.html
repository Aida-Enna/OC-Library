<!DOCTYPE HTML>
<html>
<head>
	<title id=page_title>Poniary</title>
	<meta charset="utf-8">
	<link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8%2F9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz%0AAAAOxAAADsQBlSsOGwAAAKxJREFUOI2Vk10NxDAMg%2B2pXEqhB2JoDsfQFMRKYWi8l0uVTf07vyVq%0AnC9VwkwJi9pF%2BjhTCj6ZKV0qXYNM6W2yXGyKTJUmUwq%2B%2BKtPt%2FDgCQC4VKoJAGzTlj9580sF9neh%0AhW7dWsXeJDKtE%2FQUZrgzLRO8xxoS9B4vGwDPMQ6eNTbzyIRd5GbBCok3ehDYVo0ovKw7AND22wxm%0A6%2BxXuRL4xOgmfGcTWxf2z4nfJjdq4y7K3UQAAAAASUVORK5CYII%3D%0A">
</head>
<style type="text/css">

	@media(max-width: 1080px) {
		/*Small Screens*/

		html {
			font-size: 3em;
		}

		input, textarea {
			font-size: 0.8em;
		}

		.BigUI {
			display: none;
		}

		input[type=color] {
			height: 1.5em;
			width: 4em;
		}

		select {
			font-size: 0.7em;
		}

		#SmallNavBar {
			width: 100%;
			position: fixed;
			top: 0px;
			left: 0px;
			background: #003F8C; /* Old browsers */
			background: linear-gradient(135deg,  #003F8C 0%,#000000 100%);
			border: 2px white outset;
			border-radius: 4px;
			color: white;
			padding: 6px;
		}

		#SmallMenu {
			display: none;
		}

		#SmallMenuOn {
			background: rgba(0, 0, 0, 0.5);
			z-index: 1000;
			top: 0px;
			left: 0px;
			position: fixed;
			width: 100%;
			height: 100%;
			overflow-y: scroll;
		}

		#SmallMenuContents {
			width: 100%;
		}

		#SmallMenuContents > table, #miniTOC > table {
			width: 100%;
		}

		#SmallNavBar > tbody > tr > td {
			text-align: center;
		}

		#infocontainer {
			padding-top: 2%;
			width: 100%;
		}

		#LoadUIMenu, #SaveUIMenu, #MsgBoxUI, #PonyContextMenuOn>Table {
			position: absolute;
			height: 100%;
			width: 100%;
		}

		#editorcontainer {
			height: 100%;
			width: 100%;
		}

	}

	@media(min-width: 1080px) {
		/*Regular Size Screens*/
		.SmallUI {
			display: none;
		}

		#main {
			/*Character Sheet table*/
			padding-top: 40px;
			top: 86px;
			padding-left: 210px;
			min-width: 200px;
			max-width: 1212px;
		}

		#infocontainer {
			width: 90%;
		}

		#LoadUIMenu, #SaveUIMenu, #MsgBoxUI, #PonyContextMenuOn>Table {
			position: absolute;
  			top: 50%;
  			left: 50%;
  			transform: translate(-50%, -50%);
		}

		#editorcontainer {
			margin: auto;
			width: 80%;
			padding-top: 5%;
		}

	}

	/*Apploies to everything*/
	html {
		font-family: verdana;
		text-shadow:
			-1px -1px 0 #000,
			1px -1px 0 #000,
			-1px 1px 0 #000,
			1px 1px 0 #000;
	}

	body {
		transition: ease-in-out 1s;
		background-color: black;
		background: radial-gradient(ellipse at center, #000000 0%,#00303f 100%) no-repeat center center fixed; /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
		color: #00A7FF;
	}

	.ffwin > tbody > tr > td {
		background: #003F8C; /* Old browsers */
		background: linear-gradient(135deg,  #003F8C 0%,#000000 100%);
		border: 2px white outset;
		border-radius: 4px;
		color: white;
		padding: 6px;
	}

	.crimwin {
		/*Red Final Fantasy-esque Window*/
		background: #6B0015; /* Old browsers */
		background: linear-gradient(135deg,  #6B0015 0%,#000000 100%)!important;
		border: 2px white outset;
		border-radius: 4px;
		color: white;
		padding: 6px;
	}

	.goldwin {
		/*Gold final fantasy-esque Window*/
		background: #606000; /* Old browsers */
		background: linear-gradient(135deg,  #606000 0%,#000000 100%)!important;
		border: 2px white outset;
		border-radius: 4px;
		color: white;
		padding: 6px;
	}

	.refElement {
		display: none;
	}

	.indent {
		padding-left: 54px;
	}

	.presize {
		font-size: 80%;
	}

	a:link, a:visited {
		color: #F2C574;
		text-decoration: none;
		transition: 0.2s ease-in;
	}

	a:hover {
		color: #26FF6A;
		transition: 0.2s ease-in;
	}

	input, textarea {
	  border-radius: 4px;
	  border: 1px inset rgba(255, 255, 255, 0.4);
	  background: rgba(0, 0, 0, 0.2);
	  color: white;
	}

	input[type=text][disabled], textarea[type=text][disabled] {
  		border: none;
	}

	textarea {
		width: 100%;
	}

	.codeblock {
		background: rgba(0, 0, 0, 0.5);
		border: 1px solid white;
		border-radius: 2px;
		padding: 4px;
	}


	.blockquote {
		background: rgba(0, 0, 0, 0.3);
		border: 2px dashed gray;
		border-radius: 2px;
		padding: 4px;
	}

	.quoteAuthor {
		background: rgba(0, 0, 0, 0.3);
		display: inline-block;
		font-size: 1.2em;
		border-bottom: 1px dashed gray;
		padding: 0px;
		width: 100%;
	}

	.prisma {
		animation: prisma 2s linear 0s infinite alternate;
	}

	@keyframes prisma {
		0%, 100% { color: red }
		16% { color: orange}
		32% { color: yellow}
		48% { color: green }
		64% { color: blue}
		80% { color: violet}
	}

	.spoiler {
		color: darkred;
		background: darkred;
		border-radius: 6px;
		text-shadow: none;
		transition: ease-in-out 0.5s;
	}

	.spoiler:hover {
		color: unset;
		background: rgba(139, 0, 0, 0.5);
		text-shadow:
			-1px -1px 0 #000,
			1px -1px 0 #000,
			-1px 1px 0 #000,
			1px 1px 0 #000;
		transition: ease-in-out 1s;
	}

	::-moz-selection {
		background: #C228ED;
	}

	::selection {
		background: #C228ED;
	}

	.top-button {
		position: fixed;
		right: 10px;
		bottom: 10px;
	}

	.max_width {
		width: 100%;
	}

	.list_table tr td {
		border-bottom: dotted 1px gray;
		border-right: dotted 1px gray;
	}

	.vi {
		border-left: 2px inset white;
	}

	#TableOfContents {
		position: fixed;
		padding-left: 2px;
		height: 100%;
		width: 200px;
		overflow-y: auto;
	}

	.vOverflowScroll {
		overflow-y: auto;
		max-height: 80%
	}

	#TableOfContents > table {
		width: 100%;
	}

	#editor {
		display: none;
	}

	#editorOn {
		background: rgba(0, 0, 0, 0.5);
		z-index: 1000;
		top: 0px;
		left: 0px;
		position: fixed;
		width: 100%;
		height: 100%;
		overflow-y: scroll;
	}

	#TopBar {
		position: fixed;
		width: 100%;
		padding-left: 210px;
	}

	#SaveBox, #LoadBox, #MsgBox, #PonyContextMenu {
		transition: ease-in-out 1s;
		display: none;
	}

	#SaveBoxOn, #LoadBoxOn, #MsgBoxOn, #PonyContextMenuOn {
		transition: ease-in-out 1s;
		top: 0px;
		left: 0px;
		opacity: 100%;
		visibility: visible;
		position: fixed;
		z-index: 9999;
		height: 100%;
		width: 100%;
		background: rgba(0, 0, 0, 0.5);
	}

	#MainLogo {
		background-image: url(data:image/gif;base64,R0lGODlhSgA2APMAAEYdAHMwAFhAMXJTP35cRppxVqx%2BYMKObNGZdP%2B7jgAAAAAAAAAAAAAAAAAA%0AAAAAACH5BAA8AAAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAASgA2AAAE%2FhDISae4OOtbu90g5nlB%0AaZpYoq5sq16ndF5uzWJnLucY4icC4OaV8sECu8vPZvMhcDrATHCoPhHAlzYb5CKqAqSUelimzluB%0As3o4lpICg6GXSZ%2FP38NcEgd3g4BcgURkenNhYiVxF2BXWY9%2FQitqYIdySlhCgZtdCU4YcnNvUgFx%0Ah0pqkGlcKk%2BVF3NWmZ2bW54%2BbLCISZdsV0N%2FND1PuouytmiPt3l6i6OKvaiZTC4YhrrH1C5rVXOi%0AiaXRakvaLEbXxmWzwuw0rbjdzuCmhU7lLfCX6eSRg53czb7xkuOL3L1b3SyR4UdI0z94AXeRMmWg%0A4LSD%2BRRmU1VrBUBv%2FhKhEZRFLASIjNjaBKsViRAbkM%2FCjVTZ6SAjdLHGHfR4LmJMinTWaWhCTF9O%0AIybdvfgUT%2BDEQ7meAGFDNcUkeIuM6XwRquucqz1hzvMW1RWIXH%2BwatxK0as%2BIEx9ju3TiBhVtGSG%0AvdL6o63bS3DDyuNFd5zdu1WpBFGLTWccJ5C9YnIll3DFNo6EIE6MsM1aI3IgR%2B5qmIxYy41SEbLm%0Ah%2Bfeo09CI%2BjqQ3Lc008L26sxlN1rxaAN1A41PFTppiHD9REwYKuNtJQVK8RkSrQT20gXOYW2fEAB%0A1c%2BXYvXcOLj12dijD85dkfl3LICsKhvX5jfm2MLR%2F710ez339t59%2FmfLfGlRQh5f%2BNV2XXGLCbad%0AcgAWIGA50Nk3DiwKCqcheg1Shtt%2FbQTYCVU3KMMYgoAomOFsXfT3oHYhfldTFQNWeCBs8e13yDse%0A%2BgdhjGrUdENL9N0InFRcuVWTi8nB6J5Sz0VyIo5DJsXkT2RdIGFLQ5Y45ZE78WiajzC2seUkQ6H5%0Ajn0qqdkClKxVxl4uE06izZcbQUmEORB9%2BKMfQgq5TR5ZxaKOm13yxIyfZRpWDTV4Hrrnm0v2SSZZ%0A95WUVAaR8gMnlB9dmlUdYd5U6EIXWSUfjy%2BJWk9fdcSHRnYaSYomqXwueulMQYapmZGysIRGIKG%2B%0AaNxkwmgiCLGusxiFqrKTQltsk72k5isjxRianTvc1jEtlvqoc9E95zh7jHxKWfXtWIaK62ukwz7K%0ASSGMhmLRu3k4iwm%2BJdU70yebaoDSPpoGbBhaxvJ6AQEMN%2BzwwwzfZNRlC0NsccNxGgfuKQ3ruF%2FE%0A9ITMsMd%2FYQzLJVhWTEAoF7csR8QKjWxAyxezDPKLArhMss0OZwDxzjxDfAQcBhdt9NEhxJTD0kw3%0AzfQOTkcttQkjVG311VhnjXUEACH5BAA8AAAALAAAAABKADYAhEYdAHMwAFhAMTAARH5cRmVMU2xr%0AUX9gaax%2BYMKObNGZdLyPnLSzh7CQq7Ono%2F%2B7jv%2FikMHesv%2F9v9zNyP%2FC093%2FzP%2FJ7f%2FR%2BAAAAAAA%0AAAAAAAAAAAAAAAAAAAAAAAAAAAX%2BICCO5CicaKqeZWuuMOq6QW3b6KPvfK%2BfN9Ht5CvyULekMIlS%0AOB8C6OqXcwIDy9PTaHQqkErAUJAofxXQnzodZSvKAqyYnNjm7muBt5y41rICCAhNKXl3d28JgyKB%0AcG1RkGyRVHSKg3FyNYEncGdpn49SO3pwl4JaaFKRq20PXiiCg39iAYGXWnqgeWw6X6Ung2apratr%0Ark58wJhZp3xnU49ETV%2FKm8LGeJ%2FHiYqbs5rNuKlcPiiWytfkPntlg7KZteF6W%2Bo8VufWdcPS%2FES9%0AyO28wbNVyUu9HgBP5aMXalIrdt3eMRPkjN7BY%2B1M0WFISdVDgBGX0bKFoOK4iwn%2BNabTVWwHRHci%0AwVEURi0GjJTo%2BkQrFooSH5jf4s3UKYCC0aNIkxrlhC%2FYvIsu74UMShLFAgELlq5QanTBVYLW5g0Y%0AS7bsWB4DXgWUOPLSgbcCIhQVMKGu3QkokGJdAFflUx0DuFIYsCOtVKADBxV4eyCuXLwr7J5Y6rUv%0Aur%2BBBQ8mbNjX1MQCFsONIFeAhNOoJaCoa5VvY79PMmse%2FKAzHcTMQo8mfSK1b9V0i1Z%2BfTk2BQjI%0Ak0NIOlbt59yi48atUKH3b9STh28K6ySzcuXMneNuq7ux3AjUq6vAXrSr6%2B1OuxtFjpQ%2BUttrY8Yr%0A7xh9%2Bv8qUDDZCZZxp4B3yx3%2BZd9R%2BD1H3mICGODYfxRWt9QFFwjQQAMCELedWPN9t6BRtinDFji6%0ARejAdBWm154AGF6wYYfwkQHicSIq1aAyVCnWmAEroieAeie4eBSMMnboYXwHhjjbYOIJBN2PDjAw%0AZHUAuvhihu%2FB1iSOOC63IGFRnrgfhEBa2WKFL2rn5VhginncnLSVqd8maFZ5ZQUW9GlBlu1R4GZx%0AB9ZGX3JzLkfYNrdJ%2BSCVRabXJ3V7WijgoAZyJpuOi9rZY4pASrdmpG12SeiitXGFKqP5fZpnpGuq%0At5SgpmaKllm4egoahALoSSmbgQpIa4FMQvWPZ%2BOhGJ2vlAZ4ZHuYBqPTKK3%2BUHsEUw4qy5gAagL4%0AZLQbjePPtfaAlOyZ28JK6be1SstQtVSUy825eO7mn7eagbvSuNZGNa%2Bj2prHm00w6KsPtdXm4O9P%0AAJ85hbEELhnutTshZG7D25nkESt4WFGNuydtDO82DJtJUjJfGCvFLwulzDFPJLeamELzUCMJx2nc%0AoxDIqvTbc8zZClWJHiOrw8nH4aoQ78ZA0xsLJwYZq7NKByssSkdNY9wMTSoDVKMjLR3BizkyT1QS%0A11InsvM0XXu8icmxmETwTWpT7fbc03DD48xnE0XA34AHLvjfTO189gmDJx442ZbATTPgsUQuueSE%0Ag6XQ35NnHjngsJzyqQA%2FkAui%2BOiiE1Aj5giMrngsnGMM%2BuqaTz54CoPHLrviVwCC9%2B689453UEkE%0AL%2Fzwwi9B%2FPHI2zDD8sw37%2FzzzocAACH5BAA8AAAALAAAAABKADYAhAAAAEYdAHMwAFhAMX5cRqx%2B%0AYDavfP%2F%2FAMKObNGZdFpatGtr1nR06IwAx7MB%2F819yFPP0f%2B7joCA%2F%2F%2Bb%2BZr%2F4q%2Fo5%2F%2F%2F%2FwAAAAAA%0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAX%2BYCCO5DicaKqeZWuuMOq6Qm3baKTvfK%2BfN9Ht5CvyULek%0AMIlKOCMD6OqXcwIFy9PTaHQmkMrAcIAofxPQnzodZSfKA6yYjNjm7uuBt4y41rIDBQVNKXl3d28I%0AgyKBcG1RkGyRVHSKg3FyNYEncGdpn49SO3pwl4JaaFKRq20RXiiCg39iAoGXWnqgeWw6X6Ung2ap%0Aratrrk58wJhZp3xnU49ETV%2FKm8LGeJ%2FHiYqbs5rNuKlcPiiWytfkPntlg7KZteF6W%2Bo8VufWdcPS%0A%2FES9yO28wbNVyUu9HgBP5aMXalIrdt3eMRPkjN7BY%2B1M0WFISdVDgBGX0bJVoOK4iwn%2BNabTVWwH%0ARHciwVEURi0GjJTo%2BkQrFooSH5jf4s3UOUCC0aNIkxrlhC%2FYvIsu74UMShIFAwMMjELYyhWCUqMM%0AGABTOc%2BB2bNozfJw8CqgxJGXFsg1QMGABAgW8uq1wBUphLByN1l7qsNBg8OIDzvYwVYq0IGDFMhd%0AQLcu365b9W7VCniBYKdbDCcerbaxr6mQB0ieS6EuhAqwY1fgmpdr589knooeTTqCaTqPmalm3Xqr%0A7OOz8Xq9TfaJ4QPQox8g%2FdttzHjDKddtTcE48tibmaMre1i6dNJtUQtfTbdycczgvYJlELh5AtHQ%0AE%2BdPXF093OwQcCeggJhJ8MADBj7%2BUN94TuA3HWL7IdZfcP9J9lqAA2Zol4ETTPBAhwrihoqD5j0o%0A4SvKvAXOcK%2FxleGAG37YIYie2UfieehJpQxVkS3QIoYAUADAkEG2tiGHNNbI4H3lmcibYulRuKKF%0AFVgwW2tFYsmdATF6SJ%2BSgzXYZAPRkWniYlEKtJ6PVV75IoxGPSBemPc9N92dZObZAJqOqVkhm1Zi%0ASMGMEwjY3lFzgnafb%2FmViedi2wDn55SAbiVgh0YaGmeiuTXo2268qRWpdTyyWGWAgsJYWYyc9uFp%0AYU9C%2Bs9pUmJH5WVvbhmjBK2WtVZawKapoq0%2B4uWme7oihWCvFh0k7HWbrGasoFz%2BVntkgvMtmI8%2F%0AovTArSo%2FTUqsXBfC%2BRWiX%2BK20rdU2ANSrdFOxpW55%2FKarkr6jNKKvu5yA2%2BP2r15rVKt5tuut%2Fu%2B%0AJG68AVNgUwwFM%2FRtDlH5u3BkU0AlhbbBGNyRKgi9ezFT%2BqChgiR4WFFNx81m3G%2B4w5KUzBcaS%2FHL%0AQjSzIg0vCsccyzTUoCx0FPcoxLLJ3CbtT8%2FQNtPJvgdxsvJGNfljdSFM86hQyTUXje8TFHcL8jYw%0AN90x1xoDpC5RvHjLizmkQjaUQWknYvQ0Xau8ic9z6%2F1wCjjh%2FPcKEO0od0mODEDA4ow37vjiTBmN%0A%2BAmPV9443JbwfQvjsXTuuedNkBMk%2BuKfl94547CcUqripAti%2BeuuE4Bb669bHgvqC7NeuemlP57C%0A47x%2F%2FvoVgAxu%2FPHIDx5UEsw373zzSzwv%2FfQ2zGD99dhnr332IQAAIfkEADwAAAAsAAAAAEoANgCE%0ARh0AczAAWEAxMABEflxGZUxTbGtRf2BprH5gwo5s0Zl0vI%2BctLOHsJCrs6ej%2F7uO%2F%2BKQwd6y%2F%2F2%2F%0A3M3I%2F8LT3f%2FM%2F8nt%2F9H4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABf4gII7kKJxoqp5la64w6rpB%0Abdvoo%2B98r5830e3kK%2FJQt6QwiVI4HwLo6pdzAgPL09NodCqQSsBQkCh%2FFdCfOh1lK8oCrJic2Obu%0Aa4G3nLjWsgIICE0peXd3bwmDIoFwbVGQbJFUdIqDcXI1gSdwZ2mfj1I7enCXglpoUpGrbQ9eKIKD%0Af2IBgZdaeqB5bDpfpSeDZqmtq2uuTnzAmFmnfGdTj0RNX8qbwsZ4n8eJipuzms24qVw%2BKJbK1%2BQ%2B%0Ae2WDspm14Xpb6jxW59Z1w9L8RL3I7bzBs1XJS70eAE%2FloxdqUit23d4xE%2BSM3sFj7UzRYUhJ1UOA%0AEZfRsoWg4riLCf41ptNVbAdEdyLBURRGLQaMlOj6RCsWihIfmN%2FizdQpgILRo0iTGuWEL9i8iy7v%0AhQxKEsUCAQuWrlBqdMFVgtbmDRhLtuxYHgNeBZQ48tKBtwIiFBUwoa7dCSiQYl0AV%2BVTHQO4Uhiw%0AI61UoAMHFXh7IK5cvCvsnljqtS%2B6v4EFDyZs2NfUxAIWw40gV4CE06gloKhrlW9jv08yax78oDMd%0AxMxCjyZ9IrVv1XSLVn59OTYFCMiTQ0g6Vu3n3KLjxq1Qofdv1JOHbwrrJLNy5cyd426ru7HcCNSr%0Aq8BetKvr7U67G0WOlD5S22tjxivvGH36%2FypQMNkJlnGngHfLHf5l31H4PUfeYgIY4Nh%2FFFa31AUX%0ACNBAAwIQt51Y8323oFG2KcMWOLpF6MB0FabXngAYXrBhh%2FCRAeJxIirVoDJUKdaYASuiJ4B6J7h4%0AFIwyduhhfAeGONtg4gkE3Y8OMDBkdQC6%2BGKG78HWJI44LrcgYVGeuB%2BEQFrZYoUvauflWGCKedyc%0AtJWp3yZoVnllBRb0aUGW7VHgZnEH1kZfcnMuR9g2t0n5IJVFptcndXtaKOCgBnImm46L2tljikBK%0At2akbXZJ6KK1cYUqo%2Fl9mmeka6q3lKCmZoqWWbh6ChqEAuhJKZuBCkhrgUxC9Y9n46EYna%2BUBnhk%0Ae5gGo9Morf5QewRTDirLmABqAvhktBuN48%2B19oCU7Jnbwkrpt7VKy1C1VJTLzbl47uaft5qBu9K4%0A1kY1r6PamsebTTDoqw%2B11ebg708AnzmFsQQuGe61OyFkbsPbmeQRK3hYUY27J20M7zYMm0lSMl8Y%0AK8UvC6XMMU8kt5qYQvNQIwnHadyjEMiq9NtzzNkKVYkeI6vDycfhqhDvxkDTGwsnBhmrs0oHKyxK%0AR01j3AxNKgNUoyMtHcGLOTJPVBLXUiey8zRde7yJybGYRPBNalPt9tzTcMPjzGcTRcDfgAcu%2BN9M%0A7Xz2CYMnHjjZlsBNM%2BCxRC655ISDpdDfk2ceOeCwnPKpAD%2BQC6L46KITUCPmCIyueCycYwz66ppP%0APngKg8cuu%2BJXAIL37rz3jndQSQQv%2FPDCL0H88cjbMMPyzDfv%2FPPOhwAAOw%3D%3D%0A);
		background-size: 100%;
		background-repeat: no-repeat;
		min-height: 108px;
		max-height: 108px;
		max-width: 148px;
		max-width: 148px;
	}

</style>
<style id=autosave_status type="text/css"></style>
<body>

	<table id=SmallNavBar class="SmallUI ffwin goldwin">
		<tr>
			<td onclick="OpenSmallUIMenu()">
				Menu
			</td>
			<td onclick="window.scrollTo(0,0)" title="Load Data from JSON file">
				Top
			</td>
		</tr>
	</table>

	<table id=TopBar class="ffwin BigUI">
		<tr>
			<td class=goldwin><center>♥~Poniary~♥</center></td>
		</tr>
		<tr>
			<td>
				<a href="javascript:void(0)" title="Return to Table Of Contents" onclick="showPage('Contents')">★ Home</a>
				<span style="padding-left: 15px;"></span>
				<a href="javascript:void(0)" title="Save Data to JSON file" onclick="saveBtnClick()">▼ Save</a>
				<span style="padding-left: 15px;"></span>
				<a href="javascript:void(0)" title="Load Data from JSON file" onclick="loadBtnClick()">▲ Load</a>
				<span style="padding-left: 15px;"></span>
				<a href="https://github.com/ChristianSilvermoon/Poniary" title="Open Github Repository in new tab." target="_blank">✶ GitHub</a>
			</td>
		</tr>
	</table>
	<!--End of Top Bar-->

	<div id=TableOfContents class="BigUI">Loading...<br/>Please Ensure JS is Enabled</div>
	<div id=SmallMenu class="SmallUI">
		<table class=ffwin id=SmallMenuContents>
			<tr>
				<td class=goldwin>
					<center>♥~Poniary~♥</center>
				</td>
			</tr>
			<tr>
				<td>
					<a href="javascript:void(0)" title="Close this Menu" onclick="CloseSmallUIMenu()">← Return</a>
					<br/>
					<a href="javascript:void(0)" title="Return to Table Of Contents" onclick="CloseSmallUIMenu(); showPage('Contents');">★ Home</a>
					<br/>
					<a href="javascript:void(0)" title="Save Data to JSON file" onclick="saveBtnClick(); CloseSmallUIMenu();">▼ Save</a>
					<br/>
					<a href="javascript:void(0)" title="Load Data from JSON file" onclick="loadBtnClick(); CloseSmallUIMenu();">▲ Load</a>
					<br/>
					<a href="https://github.com/ChristianSilvermoon/Poniary" title="Open Github Repository in new tab." onclick="CloseSmallUIMenu();" target="_blank">✶ GitHub</a>
				</td>
			</tr>
		</table>
		<div id=miniTOC>Ensure JS is enabled, please!</div>
	</div>
	<div id=main><br/><br/><table id=infocontainer class=ffwin></table></div>
	<div id=editor>
		<table id=editorcontainer class=ffwin><tr><td>
			Character Name: <input id=Editor_Name type=text placeholder="Character Name" onkeyup="rmIllChars(this)"></input>
			<span style="float: right;">Subtitle: <input id=Editor_Subtitle type=text placeholder="Subtitle" onkeyup="rmIllChars(this)"></input></span><hr/>

			Images: [<input id="Editor_ImageSubmitter" type=file accept="image/*"></input> <a href="javascript:void(0)" onclick="editorFunc('newImg')">+Add</a>]<br/>
			<table class=list_table id="Editor_Images"></table><br/>
			<br/>
			Background Color: <input id=Editor_Bkg type=color></input><br/>
			Creator: <input id=Editor_Creator type=text placeholder="Creator Name" onkeyup="rmIllChars(this)"></input> [<a href="javascript:void(0)" onclick="document.getElementById('Editor_Creator').value = ponydata.MetaInf.author" title="Set as Author of Save From Meta Information">Set As Author</a>]<br/>
			Birth Date: <input id=Editor_DOB type=text placeholder="Birth Date" onkeyup="rmIllChars(this)"></input><br/>
			Birth Place: <input id=Editor_BirthPlace type=text placeholder="Birth Place" onkeyup="rmIllChars(this)"></input><br/>
			Race: <input id=Editor_Race type=text placeholder="Birth Place" onkeyup="rmIllChars(this)"></input><br/>
			Gender: <select id=Editor_Gender type=listbox>
					<option>Undefined</option>
					<option>Female</option>
					<option>Intersex</option>
					<option>Male</option>
					<option>N/a</option>
					<option>Other</option>
				</select><br/>
			Orientation: <input id=Editor_Orientation type=text placeholder="Orientation" onkeyup="rmIllChars(this)"></input><br/>
			Occupation: <input id=Editor_Occupation type=text placeholder="Occupation" onkeyup="rmIllChars(this)"></input><br/>
			Special Talent: <input id=Editor_Talent type=text placeholder="Special Talent" onkeyup="rmIllChars(this)"></input><br/>
			Cutie Mark: <input id=Editor_CutieMark type=text placeholder="Cutie Mark" onkeyup="rmIllChars(this)"></input><br/>
			Universe: <input id=Editor_Universe type=text placeholder="Universe" onkeyup="rmIllChars(this)"></input><br/>
			<br/>
			Custom Fields: [<a href="javascript:void(0)" onclick="editorFunc('newCustField')">+New</a>]<br/>
			<table class=list_table id="Editor_CustomFields"></table>
			<br/>
			Coloration: [<a href="javascript:void(0)" onclick="editorFunc('newColor')">+New</a>]<br/>
			<table class=list_table id="Editor_Colors"></table>
			<br/>
			Family: [<a href="javascript:void(0)" onclick="editorFunc('newFamily')">+New</a>]<br/>
			<table class=list_table id="Editor_Family"></table>
			<br/>
			Description:<br/>
			<textarea rows=10 id=Editor_Description onkeyup="rmIllChars(this)"></textarea><br/>
			<br/>
			Abilities: [<a href="javascript:void(0)" onclick="editorFunc('newAbility')">+New</a>]<br/>
			<table class=list_table id="Editor_Abilities"></table><br/>
			<br/>
			<hr/><br/>
			<center><a href="javascript:void(0)" onclick="editorSav('save')">Save</a><br/>
			<a href="javascript:void(0)" onclick="editorSav('cancel')">Discard</center><br/>
		</td></tr></table>
	</div>
	<div id="BBCode_Ref" class="refElement">
		<table id="infocontainer" class=ffwin>
			<tr>
				<td>
					BBCode Reference<hr/>
					Bulletin Board Code is pretty common place on the Internet today... and you can use it here too!<br/>
					<br/>
					<center>
					BBCode is supported in <i>nearly</i> all feilds! Feel free to experiment!<br/>
					<span class=prisma>Go nuts!</span>
					<br/>

					<table class=list_table>
						<tr>
							<td colspan=2><center>Supported BBCode</center></td>
						</tr>
						<tr>
							<td>BBCode</td><td>Result</td>
						</tr>
						<tr>
							<td>[b]Bold Text[/b]</td><td><b>Bold Text</b></td>
						</tr>
						<tr>
							<td>[i]Italic Text[/i]</td><td><i>Italic Text</i></td>
						</tr>
						<tr>
							<td>[u]Underlined Text[/u]</td><td><u>Underlined Text</u></td>
						</tr>
						<tr>
							<td>[s]Struckthrough Text[/s]</td><td><s>Struckthrough Text</s></td>
						</tr>
						<tr>
							<td>This is [sup]Superscript[/sup]</td><td>This is <sup>Superscript</sup></td>
						</tr>
						<tr>
							<td>This is [sub]Subscript[/sup]</td><td>This is <sub>Subscript</sub></td>
						</tr>
						<tr>
							<td>This is a [url=http://example.com]Named Link[/url]</td><td>This is a <a href="http://example.com" target="_blank" title="Link to:&#10;http://example.com">Named Link</a></td>
						</tr>
						<tr>
							<td>This is a regular link: [url]http://example.com[/url]</td><td>This is a regular link: <a href="http://example.com" target="_blank" title="Link to:&#10;http://example.com">http://example.com</a></td>
						</tr>
						<tr>
							<td>This text is [color=orange]Colored[/color]</td><td>This text is <font color=orange>Colored</font></td>
						</tr>
						<tr>
							<td>[code]This is a codeblock[/code]</td><td><div class=codeblock>This is a codeblock</div></td>
						</tr>
						<tr>
							<td>[quote=Author says]Authored Quote[/quote]</td><td><div class=blockquote><div class=quoteAuthor>Author says</div>Authored Quote</div></td>
						</tr>
						<tr>
							<td>[quote]Unauthored Quote[/quote]</td><td><div class=blockquote>Unauthored Quote</div></td>
						</tr>
						<tr>
							<td>[prisma]Prismatic/Rainbow Text[/prisma]</td><td><span class=prisma>Prismatic/Rainbow Text<span></td>
						</tr>
						<tr>
							<td>[spoiler]Spoiered Text[/spoiler]</td><td><span class=spoiler>Spoilered Text</span></td>
						</tr>
						<tr>
							<td>[highlight=yellow]Highlighted Text[/highlight]</td><td><span style="background: yellow; padding: 2px; border-radius 6px;">Highlighted Text</span></td>
						</tr>
					</table>
					</center>
				</td>
			</tr>
		</table>
	</div>
	<div id="Page_Help" class="refElement">
		<table id="infocontainer" class=ffwin>
			<tr>
				<td>
					Help<hr/>
					<center>
						Finding yourself confused? Not sure what to do? <br/>No worries! This help page is here to help you get started!<br/>
					</center>
					<br/>
					<b>Standard Interface</b><br/>
					On a large screen, you'll see the standard interface. <br/>
					<br/>
					The side bar on the left is called the <u>Character List</u>.<br/>
					The character list is where all of your characters will be displayed. To create a new one, simply click the <b>+</b>, doing so will
					create your new character and pull them up in the Character Editor. When your satisfied with your changes, click Save.<br/>
					<br/>
					The <b>?</b> pulls up the context menu of the character your currently viewing. You can also do this by Right Clicking (or <i>Long Pressing</i>, on a touch screen).
					This menu will show you the character's position in your list, their name, and their estimated contribution to the file size of your save.
					You can move the character up or down in the list, edit them, copy them, save them to their own seperate save file, or delete them through this menu.<br/>
					<br/>
					The <b>M</b> pulls up the Character List Menu. This powerful screen allows you to re-organize your list using alphabetical sorting, reverse alphabetical sorting, or
					flipping the list backwards altogether. It also allows you to search through your characters (which is useful if you have many of them) using <a href=https://en.wikipedia.org/wiki/Regular_expression target="_blank" title="Wikipedia Artical on Regular Expressions">Regular Expressions</a> or
					"RegExp" for short. RegExp may seem daunting to beginners, but it's quite easy and many cheatsheets are available online. If you can't be bothered with the more complex features of RegExp, just start typing a character's name and you'll be okay!<br/>
					<br/>
					The <b>Top Bar</b> contains a variety of useful clickable links that do stuff!<br/>
					<br/>
					<b>Home</b> takes you to the table of contents, where all the less important things (IE not your characters) are.<br/>
					<br/>
					<b>Save</b> will allow you to save all of your data to a file we'll call "<code style='background: rgba(0,0,0,0.2);'>PoniarySave.json</code>".

					<b>Load</b> has some very interesting and to some, probably unusual options inside. There are <i>three</i> modes of loading files. The default is <u>Overwrite</u>, which works just like the standard file loading you're already accustomed to.
					<u>Prepend</u> will load the characters from the loaded file onto the start of your list. <u>Append</u> will load the characters from the loaded file onto the end of your list.<br/>
					<br/>
					Loaded files are <i>u</i> automatically updated to comply with the current version of Poniary, so it should be hassle free... if you happen to load a newer save file in an older version, you'll get a spooky warning!<br/>
					<br/>
					Whenever you load a file a sort of "Restore Point" is created. You can use <u>Restore</u> from the load menu to revert back to before you loaded the last file at any time. Be careful however, after you use your Restore Point
					it will dissapear! This was added to protect against data loss from loading incompatible saves and for the sake of general convenience.<br/>
					<br/>
					Lastly, the GitHub link will take you to Poniary's GitHub Repository.<br/>
					<br/>
					<b>Compact Interface</b><br/>
					If you're on a smaller (or zoomed in enough) screen, you're gonna see this one.<br/>
					<br/>
					This interface is basically the same, but the Character List and Top Bar are now located inside of a menu to save on screen space and certain things will show in fullscreen instead of smaller windows.<br/>
					<br/>
					<b>Meta Information</b><br/>
					Meta Information is Information ABOUT your save! This includes things like who made it (likely yourself), whether or not it's locked (changes prevented), and whether or not you want your save to be Pretty Printed.<br/>
					<br/>
					Pretty Printing makes the save files more easily readable to humans, so it's a good option if you wanna take a look at how the file's laid out.
					<br/><br/>
					<b><u>Tip: Keyboard Shortcuts</u></b><br/>
					Hotkeys make life a lot easier. Here are some you can use here! How hot are your hotkey skills?<br/>
					<br/>
					<table class="list_table">
						<tr>
							<td>Key</td><td>Function</td>
						</tr>
						<tr>
							<td>ESC</td><td>Close/dismiss most dialog boxes.</td>
						</tr>
						<tr>
							<td>&lt;</td><td>Go up one character in the character list. While viewing a character only.</td>
						</tr>
						<tr>
							<td>&gt;</td><td>Go down one character in the character list. While viewing a character only.</td>
						</tr>
						<tr>
							<td>M</td><td>Open Table of Contents Menu. While viewing a character page only.</td>
						</tr>
						<tr>
							<td>?</td><td>View character context menu. While viewing a character page only.</td>
						</tr>
						<tr>
							<td>+</td><td>Create new character. While viewing a character page only.</td>
						</tr>
					</table>
					<br/>
					<b><u>Tip: Reducing Save File Size</u></b><br/>
					Bumping into a limit on sharing files over a messenger? Just want your Save Data smaller? Here are some easy solutions!<br/>
					<br/>
					<u>Division</u><br/>
					Hover over the characters in your list... do you see the file sizes? These contribute to your total! You could try <i>saving</i> your larger characters to their own files and deleting them from your
					current save! You still have all the details, just across multiple files instead of one.<br/>
					<br/>
					<u>Watching your Pictures</u><br/>
					Did you know pictures are <i>larger than text</i>? It's true! Choosing your pictures <i>wisely</i> can have massive impact on file size! Poniary displays images at 100x100 when viewing and 50x50 when editing.
					While you <i>can</i> store images of any type and resolution you want, it may not be needed. Additionally, certain file types are HUGE compared to others, so choose your image formats wisely.<br/>
					<br/>
				</td>
			</tr>
		</table>
	</div>
	<div id="SaveBox"></div>
	<div id="LoadBox"></div>
	<div id="MsgBox"></div>
	<div id="PonyContextMenu" style="overflow-y: auto;">
		<table class=ffwin>
			<tr>
				<td>
					<center>
					<b><u>-Pony Menu-</b></u><br/>
					<br/>
					</center>
					Position: <span style="color: #26FF6A;" id="PonyContextMenuPos"></span><br/>
					Pony: <span style="color: #26FF6A;" id="PonyContextMenuName"></span><br/>
					<span title="Estimated, not exact">Size</span>: <span style="color: #26FF6A;" id="PonyContextMenuSize"></span><br/>
					<center>
					<span class="lockable"><br/>
					Move: <a href="javascript:void(0)" title="Move character up in list" onclick="movePone('up');">↑ Up</a>/<a href="javascript:void(0)" title="Move character down in list" onclick="movePone('down');">↓ Down</a><br/><br/>
					<a href="javascript:void(0)" title="Edit Character" onclick="editBtnClick(); document.getElementById('PonyContextMenuOn').id = 'PonyContextMenu'">Edit Character</a><br/>
					<a href="javascript:void(0)" ttile="Copy Character" onclick="copyPony();document.getElementById('PonyContextMenuOn').id = 'PonyContextMenu'">Copy Character</a></span><br/>
					<span id="PonyContextMenuSave" onclick="document.getElementById('PonyContextMenuOn').id = 'PonyContextMenu'"></span><br/>
					<span class="lockable"><a href="javascript:void(0)" title="Delete Character" onclick="delBtnClick(); document.getElementById('PonyContextMenuOn').id = 'PonyContextMenu'">Delete Character</a><br/></span><br/>
					<a href="javascript:void(0)" title="ESC" onclick="document.getElementById('PonyContextMenuOn').id = 'PonyContextMenu'">Return</a><br/>
					</center>
				</td>
			</tr>
		</table>
	</div>

	<script>
		const bugReportURL = "https://github.com/ChristianSilvermoon/Poniary/issues/new?labels=bug&title=New+bug+report&template=bug_report.md";
		const featureRequestURL = "https://github.com/ChristianSilvermoon/Poniary/issues/new?labels=Feature+Request&title=New+Feature+Request&template=feature_request.md";

		/* --------------------------
		 * Start of Class Definitions
		 */

		class urlParameters {
			constructor( url = window.location.href) {
				//Initizalize
				this.url = url;
				var params = this.url.split("?");

				params.shift();
				this.params = params.toString().split("&");
			}

			get(target) {
				//Get value of specified target
				for( var i = 0; i < this.params.length; i++ ) {
					var test = this.params[i].split("=");

					if( test[0] == target ) {
						return test[1]; // Return Target's value
					}
				}

				return null; //Return null if target doesn't exist
			}
		}

		/*
		 * End of Class Definitions
		 * ------------------------- */

		const Parameters = new urlParameters();


		function ponyContextMenu() {
			if ( typeof viewing == "number" ) {
				var singlePoneData = {};
				singlePoneData.MetaInf = JSON.parse(JSON.stringify(ponydata.MetaInf));
				singlePoneData.TableOfContents = [];
				singlePoneData.TableOfContents[0] = JSON.parse(JSON.stringify(ponydata.TableOfContents[viewing]));

				if ( singlePoneData.MetaInf.pretty == true ) {
					var data = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(singlePoneData, null, 3));

				} else {
					var data = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(singlePoneData));
				}

				document.getElementById('PonyContextMenuSave').innerHTML = "<a href=\"" + data + "\" download=\"PoniarySave.json\" onclick=\"origponydata = Object.assign(ponydata); CloseSaveBox();\">Save Character</a>";

				document.getElementById('PonyContextMenuName').innerHTML = bbCodeDecode( bbCodeStrip(ponydata.TableOfContents[viewing].name, [ "quote", "code", "authoredQuote"]));
				document.getElementById('PonyContextMenuSize').innerHTML = getSizeEstimate(ponydata.TableOfContents[viewing]);
				document.getElementById('PonyContextMenuPos').innerHTML = (viewing + 1) + "/" + ponydata.TableOfContents.length;


				document.getElementById('PonyContextMenu').id = "PonyContextMenuOn";
			} else {
				msgBox("Select a Pony first.","-Pony Menu-");
			}
		}

		function TocSearch(query) {
			query = query.toLowerCase();
			var sresults = "";
			var resultCount = 0;
			if ( query.length != 0) {
				for ( i = 0; i < ponydata.TableOfContents.length; i++ ) {
					//find me
					console.log("Iteration: " + i);
					if ( (bbCodeStrip(ponydata.TableOfContents[i].name).toLowerCase().search(query) == 0 ) && ( resultCount < 5) ) {
						sresults = sresults.concat("<a href=\"javascript:void(0)\" onclick=\"loadPon(" + i + "); CloseMsgBox(); CloseSmallUIMenu();\">" + bbCodeDecode( bbCodeStrip( ponydata.TableOfContents[i].name, [ "quote", "url", "namedURL", "code", "authoredQuote"])) + "</a><br/>");
						resultCount++
					}
				}
			}
			document.getElementById('TocMenuSearchResults').innerHTML = sresults
		}

		function TocMenu() {
			var tdata = "<span class=lockable>Sort: <a href=\"javascript:void(0)\" onclick=\"sortPons('AZ'); CloseMsgBox()\" title=\"Sort Alphabetically\">[A-Z]</a> <a href=\"javascript:void(0)\" onclick=\"sortPons('ZA'); CloseMsgBox()\" title=\"Sort Reverse Alphabetically\">[Z-A]</a> <a href=\"javascript:void(0)\" onclick=\"sortPons('REV'); CloseMsgBox()\" title=\"Reverse List\">[REV]</a><br/></span><br/>Character Search:<br/><input id=TocMenuSearch type=text onkeyup=\"TocSearch(this.value);\" placeholder=\"RegExp Search\"></input><br/><div id=TocMenuSearchResults style=\"background: black; border-radius: 4px;\"></div>"
			msgBox(tdata, "Table Of Contents Menu")
		}

		function copyPony() {
			var newslot = ponydata.TableOfContents.length;
			var current = viewing;
			ponydata.TableOfContents[newslot] = JSON.parse(JSON.stringify(ponydata.TableOfContents[viewing]));
			setStage();
			loadPon(current);
			msgBox("Successfully copied <b>" + bbCodeStrip(ponydata.TableOfContents[current].name) + "</b>!","Copied Character");
		}

		function movePone(dir) {
			if ( (viewing > 0)&&(dir == "up" ) ) {
				var tmpPony = JSON.stringify( ponydata.TableOfContents[viewing] );
				ponydata.TableOfContents[viewing] = JSON.parse( JSON.stringify( ponydata.TableOfContents[(viewing - 1)] ));
				ponydata.TableOfContents[(viewing - 1)] = JSON.parse(tmpPony);
				var slot = (viewing - 1);
				setStage();
				loadPon(slot);
				document.getElementById('PonyContextMenuOn').id = "PonyContextMenu";
				ponyContextMenu();

			} else if ( (viewing < (ponydata.TableOfContents.length - 1) )&&(dir == "down") ) {
				var tmpPony = JSON.stringify( ponydata.TableOfContents[viewing] );
				ponydata.TableOfContents[viewing] = JSON.parse( JSON.stringify( ponydata.TableOfContents[(viewing + 1)] ));
				ponydata.TableOfContents[(viewing + 1)] = JSON.parse(tmpPony);
				var slot = (viewing + 1);
				setStage();
				loadPon(slot);
				document.getElementById('PonyContextMenuOn').id = "PonyContextMenu";
				ponyContextMenu();
			}
		}

		function sortPons(method) {
			if ( method == "AZ" || method == "ZA" ) {
				var ponlist = JSON.parse( JSON.stringify(ponydata.TableOfContents) );
				var sortinglist = [];
				for ( i = 0; i < ponlist.length; i++ ) {
					sortinglist[i] = [ bbCodeStrip(ponlist[i].name), i ];
				}
				sortinglist = sortinglist.sort();

				console.log(sortinglist);
				for ( i = 0; i != ponlist.length; i++ ) {
					console.log(i, ":", sortinglist[i], ponlist[sortinglist[i][1]]);
					ponydata.TableOfContents[i] = ponlist[sortinglist[i][1]];
				}

				if ( method == "ZA" ) {
					ponydata.TableOfContents.reverse();
				}
			} else if ( method == "REV" ) {
				ponydata.TableOfContents.reverse();
			}
			setStage();
		}

		function newBtnClick() {
			var newCharString = "{\"name\":\"New Pony\",\"bkg\":\"#003F8C\",\"img\":[],\"subtitle\":\"New Character\",\"creator\":\"unknown\",\"dob\":\"unknown\",\"birth_place\":\"unknown\",\"race\":\"unknown\",\"gender\":\"Undefined\",\"orientation\":\"unknown\",\"occupation\": \"unknown\",\"special_talent\":\"unknown\",\"cutie_mark\":\"unknown\",\"universe\":\"unknown\",\"customFields\":[],\"colors\":[],\"family\":[],\"bio\":\"This is a new, unedited character.\\n\\nUse the editor and make them yours!\",\"abilities\":[]}";
			var newPonySlot = ponydata.TableOfContents.length;
			ponydata.TableOfContents[newPonySlot] = JSON.parse(newCharString);
			msgBox("A new character's been added!<br/>Why not fill in some details?","Character Created")
			setStage();
			loadPon(newPonySlot)
			editBtnClick();
		}

		function editorSav(opt) {
			if(opt == "cancel") {
				//Cancel Button
				msgBox("Do you really want to discard <u>All Changes</u> to <br/><b>" + bbCodeStrip(ponydata.TableOfContents[viewing].name) +"</b>?<br/><br/><a href=\"javascript:void(0)\" onclick=\"editorSav('confirmdiscard'); CloseMsgBox()\">Yes, Really.</a><br/><a href=\"javascript:void(0)\" onclick=\"editorSav('save'); CloseMsgBox();\">Actually, I meant save.</a>", "Discard?");
			} else if (opt == "confirmdiscard") {
				//Confirm Cancel
				document.getElementById('editorOn').id = "editor";
			} else if (opt == "save") {
				//Save Button
				editorPony.name = document.getElementById("Editor_Name").value;
				editorPony.subtitle = document.getElementById("Editor_Subtitle").value;

				//imgTb.firstChild.children[0].children[1].firstChild.attributes.src.nodeValue
				var imgFinal = []; //New Array
				var imgTb = document.getElementById("Editor_Images");
				if (imgTb.firstChild != null) {
					for (i = 0; i < imgTb.firstChild.children.length; i++) {
						imgFinal[i] = [ imgTb.firstChild.children[i].children[2].firstChild.value, imgTb.firstChild.children[i].children[1].firstChild.attributes.src.nodeValue ];
					}
				}
				editorPony.img = imgFinal;

				editorPony.bkg = document.getElementById("Editor_Bkg").value;
				editorPony.creator = document.getElementById("Editor_Creator").value;
				editorPony.dob = document.getElementById("Editor_DOB").value;
				editorPony.birth_place = document.getElementById("Editor_BirthPlace").value;
				editorPony.race = document.getElementById("Editor_Race").value;
				editorPony.gender = document.getElementById("Editor_Gender").value;
				editorPony.orientation = document.getElementById("Editor_Orientation").value;
				editorPony.occupation = document.getElementById("Editor_Occupation").value;
				editorPony.special_talent = document.getElementById("Editor_Talent").value;
				editorPony.cutie_mark = document.getElementById("Editor_CutieMark").value;
				editorPony.universe = document.getElementById("Editor_Universe").value;

				//Custom Fields
				var custFields = []; //New Array
				var cftb = document.getElementById("Editor_CustomFields");
				if (cftb.firstChild != null) {
					for (i = 0; i < cftb.firstChild.children.length; i++) {
						if ( cftb.firstChild.children[i].children[1].firstChild.value.length > 0) {
							//Ensure first field has a name
							custFields[i] = [cftb.firstChild.children[i].children[1].firstChild.value, cftb.firstChild.children[i].children[2].firstChild.value ];
						}
					}
				}
				editorPony.customFields = custFields;
				//Colors
				var epColorsFinal = []; //New Array
				var epcolors = document.getElementById("Editor_Colors");
				if (epcolors.firstChild != null) {
					for (i = 0; i < epcolors.firstChild.children.length; i++) {
							epColorsFinal[i] = [epcolors.firstChild.children[i].children[1].firstChild.value.toUpperCase(), epcolors.firstChild.children[i].children[2].firstChild.value ];
					}
				}
				editorPony.colors = epColorsFinal;

				//Family
				var famFinal = []; //New Array
				var familyTb = document.getElementById('Editor_Family');
				if (familyTb.firstChild != null) {
					for (i = 0; i < familyTb.firstChild.children.length; i++) {
						if ( familyTb.firstChild.children[i].children[1].firstChild.value.length > 0) {
							//Ensure first field has a name
							famFinal[i] = [familyTb.firstChild.children[i].children[1].firstChild.value, familyTb.firstChild.children[i].children[2].firstChild.value ];
						}
					}
				}
				editorPony.family = famFinal;

				editorPony.bio = document.getElementById("Editor_Description").value;

				//Abilities
				var abFinal = []; //New Array
				var abTb = document.getElementById('Editor_Abilities');
				if ( abTb.firstChild != null) {
					for (i = 0; i < abTb.firstChild.children.length; i++) {
						abFinal[i] = [ abTb.firstChild.children[i].children[1].firstChild.value, abTb.firstChild.children[i].children[2].firstChild.value, abTb.firstChild.children[i].children[3].firstChild.value, abTb.firstChild.children[i].children[4].firstChild.value ];
					}
				}
				editorPony.abilities = abFinal;

				msgBox("Really save changes to <b>" + bbCodeStrip(ponydata.TableOfContents[viewing].name) + "</b><br/><br/><a href=\"javascript:void(0)\" onclick=\"editorSav('saveconfirm'); CloseMsgBox();\">Yes, Save!</a><br/><a href=\"javascript:void(0)\" onclick=\"editorSav('cancel'); CloseMsgBox();\">Actually, I meant Discard</a>","Really Save?");
			} else if (opt == "saveconfirm") {
				//Save was confirmed
				ponydata.TableOfContents[viewing] = JSON.parse(JSON.stringify(editorPony));
				document.getElementById('editorOn').id = "editor";
				var tmpview = viewing;
				setStage();
				loadPon(tmpview);
			}
		}

		function editorFunc(arg) {
			if(arg == "newCustField") {
				var tb = document.getElementById('Editor_CustomFields');
				tb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Field\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Value\"></input></td>"
			} else if (arg == "newColor") {
				var tb = document.getElementById('Editor_Colors');
				tb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><input type=\"color\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"What holds this color?\"></input></td>"
			} else if (arg == "newFamily") {
				var tb = document.getElementById('Editor_Family');
				tb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Relation\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Family Member Name\"></input></td>"
			} else if (arg == "newAbility") {
				var abilityTb = document.getElementById('Editor_Abilities');
				abilityTb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Type\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Subtype\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Name\"></input></td><td style=\"min-width: 400px;\"><textarea rows=3 onkeyup=\"rmIllChars(this)\" placeholder=\"Description\"></textarea></td>";
			} else if (arg == "newImg") {
				var reader = new FileReader();
				var file = document.getElementById('Editor_ImageSubmitter').files[0];
				var imgTb = document.getElementById('Editor_Images');

				reader.onload = function(event) {
					imgTb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><img width=50px height=50px src=\"" + event.target.result + "\"></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Image Name\" value=\"" + file.name + "\"></input></td>"
				}

				reader.readAsDataURL(file);
			}
		}

		function saveBtnClick() {
			if ( ponydata.MetaInf.pretty == true) {
				var data = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(ponydata, null, 3));
			} else {
				var data = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(ponydata));
			}
			console.log(data);
			document.getElementById('SaveBox').innerHTML = "<table class=ffwin id=SaveUIMenu><tr><td><center><b><u>-Save Menu-</b></u><br/><br/><center><a href=\"" + data + "\" download=\"PoniarySave.json\" onclick=\"origponydata = Object.assign(ponydata); CloseSaveBox();\">Save</a><br/><span title=\"ESC\" onclick=\"CloseSaveBox()\"><a href=\"javascript:void(0)\">Return</a></span></center></td></tr></table></center>";
			document.getElementById('SaveBox').id = "SaveBoxOn";
		}

		function loadBtnClick() {
			var tableContent = "<center><table class=ffwin id=LoadUIMenu><tr><td><b><u><center>-Load Menu-</b></u><br/><br/>";
			if ( JSON.stringify(ponydata) != JSON.stringify(origponydata) ) {
				tableContent = tableContent.concat("<font color=red>There are unsaved changes!</font><br/><br/>");
			}

			tableContent = tableContent.concat("</center><form id=LoadFileMode><span class=\"lockable\"><input type=radio name=mode>Prepend</input><br/></span><input type=radio checked=true name=mode>Overwrite</input><br/><span class=\"lockable\"><input type=radio name=mode>Append</input></span></form><center>")
			tableContent = tableContent.concat("<input id=LoadFileBox type=file accept=\"application/json, .json \"></input><br/><br/><span onclick=\"loadFile()\"><a href=\"javascript:void(0)\">Load</a></span></br>");
			if ( JSON.stringify(undoLoad) != "{}" ) {
				tableContent = tableContent.concat("<span onclick=\"undoLoadFile()\"><a href=\"javascript:void(0)\">Restore</a></span><br/>")
			}
			tableContent = tableContent.concat("<span title=\"ESC\" onclick=\"CloseLoadBox()\"><a href=\"javascript:void(0)\">Return</a></span></center></td></tr></table>");
			document.getElementById('LoadBox').innerHTML = tableContent;
			document.getElementById('LoadBox').id = "LoadBoxOn";
		}

		function delBtnClick() {

			if (typeof viewing == "number") {
				var pone = bbCodeStrip(ponydata.TableOfContents[viewing].name);
				var msg = "You'd delete <b><i>" + pone + "?!</b></i><br/>" + pone + " looks scared.<br/>" + pone + " feels betrayed.<br/>" + pone + " trusted you.<br/>" + pone + " <b><u>LOVED</b></u> you!<br/>You Monster.<br/><br/><a href=\"javascript:void(0);\" onclick=\"delPony(); CloseMsgBox();\">I'm heartless. Do It.</a>"
				msgBox(msg,"Delete Pony?");
			} else {
				msgBox("Select a pony to delete first!","Editor Error");
			}
		}

		function delPony() {
			if (typeof viewing == "number") {
				var oldponyname = ponydata.TableOfContents[viewing].name
				ponydata.TableOfContents.splice(viewing,1);
				setStage();
				msgBox("Looks like <b>" + oldponyname + "</b> may be gone forever...<br/>");
			}
		}

		var editorPony = {}
		function editBtnClick() {

			if (typeof viewing == "number") {
				//Prep Editor Window and make it visible
				editorPony = JSON.parse(JSON.stringify(ponydata.TableOfContents[viewing]));
				document.getElementById("Editor_Name").value = ponydata.TableOfContents[viewing].name;
				document.getElementById("Editor_Subtitle").value = ponydata.TableOfContents[viewing].subtitle;

				//Images
				var imgTb = document.getElementById('Editor_Images');
				imgTb.innerHTML = ""; //Clear Table
				for(i = 0; i < ponydata.TableOfContents[viewing].img.length; i++) {
					imgTb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><img width=50px height=50px src=\"" + ponydata.TableOfContents[viewing].img[i][1] + "\"></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Image Name\" value=\"" + ponydata.TableOfContents[viewing].img[i][0] + "\"></input></td>"
				}


				document.getElementById("Editor_Bkg").value = ponydata.TableOfContents[viewing].bkg;
				document.getElementById("Editor_Creator").value = ponydata.TableOfContents[viewing].creator;
				document.getElementById("Editor_DOB").value = ponydata.TableOfContents[viewing].dob;
				document.getElementById("Editor_BirthPlace").value = ponydata.TableOfContents[viewing].birth_place;
				document.getElementById("Editor_Race").value = ponydata.TableOfContents[viewing].race;
				document.getElementById("Editor_Gender").value = ponydata.TableOfContents[viewing].gender;
				document.getElementById("Editor_Orientation").value = ponydata.TableOfContents[viewing].orientation;
				document.getElementById("Editor_Occupation").value = ponydata.TableOfContents[viewing].occupation;
				document.getElementById("Editor_Talent").value = ponydata.TableOfContents[viewing].special_talent;
				document.getElementById("Editor_CutieMark").value = ponydata.TableOfContents[viewing].cutie_mark;
				document.getElementById("Editor_Universe").value = ponydata.TableOfContents[viewing].universe;

				//Custom Fields
				var customFtb = document.getElementById('Editor_CustomFields');
				customFtb.innerHTML = ""; //Clear Table
				for(i = 0; i < ponydata.TableOfContents[viewing].customFields.length; i++) {
					customFtb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Field\" value=\"" + ponydata.TableOfContents[viewing].customFields[i][0] + "\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Value\" value=\"" + ponydata.TableOfContents[viewing].customFields[i][1] + "\"></input></td>"
				}

				//Coloration
				var colorTb = document.getElementById('Editor_Colors');
				colorTb.innerHTML = ""; //Clear Table
				for (i = 0; i < ponydata.TableOfContents[viewing].colors.length; i++) {
					colorTb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><input type=\"color\" value=\"" + ponydata.TableOfContents[viewing].colors[i][0] + "\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"What holds this color?\" value=\"" + ponydata.TableOfContents[viewing].colors[i][1] + "\"></input></td>"
				}

				//Family
				var familyTb = document.getElementById('Editor_Family');
				familyTb.innerHTML = ""; //Clear Table
				for (i = 0; i < ponydata.TableOfContents[viewing].family.length; i++) {
					familyTb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Relation\" value=\"" + ponydata.TableOfContents[viewing].family[i][0] + "\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Family Member Name\" value=\"" + ponydata.TableOfContents[viewing].family[i][1] + "\"></input></td>"
				}

				//BIO
				document.getElementById("Editor_Description").value = ponydata.TableOfContents[viewing].bio;

				//Abilities (This is the hard part :D)
				var abilityTb = document.getElementById('Editor_Abilities');
				abilityTb.innerHTML = ""; //Clear Table
				for (i = 0; i < ponydata.TableOfContents[viewing].abilities.length; i++) {
					abilityTb.insertRow().innerHTML = "<td><a href=\"javascript:void(0)\" onclick=\"this.parentNode.parentNode.remove()\">X</a></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Type\" value=\"" + ponydata.TableOfContents[viewing].abilities[i][0] + "\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Subtype\" value=\"" + ponydata.TableOfContents[viewing].abilities[i][1] + "\"></input></td><td><input type=\"text\" onkeyup=\"rmIllChars(this)\" placeholder=\"Name\" value=\"" + ponydata.TableOfContents[viewing].abilities[i][2] + "\"></input></td><td style=\"min-width: 400px;\"><textarea rows=3 onkeyup=\"rmIllChars(this)\" placeholder=\"Description\">" + ponydata.TableOfContents[viewing].abilities[i][3] + "</textarea></td>"
				}


				document.getElementById("editor").id = "editorOn";
			} else {
				msgBox("Select a pony to edit first!","Editor Error");
			}
		}

		function unloadBtnClick(value) {
			if (value == "y") {
				location.reload();
			} else {
				//Prompt for unload
				msgBox("Drop <i>everything</i> and start fresh?<br/><br/><a href=\"javascript:void(0)\" onclick=\"unloadBtnClick('y');\">Do It!</a>","Unload?");
			}
		}

		function CloseSaveBox() {
			document.getElementById('SaveBoxOn').id = "SaveBox";
			document.getElementById('SaveBox').innerHTML = "";
		}

		function CloseLoadBox() {
			document.getElementById('LoadBoxOn').id = "LoadBox";
			document.getElementById('LoadBox').innerHTML = "";
		}

		var msgQ = []; //Q for MsgBox() and CloseMsgBox()
		function msgBox(body, title) {
			//Give Defaults for ungiven arguments
			if ( title == null ) {
				title = "Notice";
			}
			if ( body == null ) {
				body = "Test Message.";
 			}
			//If a msgbox is already open...
			var element = document.getElementById("MsgBox");
			if ( element === null ) {
				//determine available slot in que
				var slap = 1;
				for (i = 1; msgQ[i] != undefined; i++) {
					console.log("Slot: ", msgQ[i]);
					slap++;
				}
				//Store Message to be displayed next
				msgQ[slap] = [body, title];

			} else {
				//Message box wasn't already open, display message NOW
				var tableContent = "<table class=ffwin id=MsgBoxUI><tr><td><b><u><center>-";
				tableContent = tableContent.concat(title, "-</b></u><br/><br/>");
				tableContent = tableContent.concat(body, "<br/><br/>");
				tableContent = tableContent.concat("<span title=\"ESC\" onclick=\"CloseMsgBox()\"><a href=\"javascript:void(0)\">Return</a></span>")
				document.getElementById('MsgBox').innerHTML = tableContent;
				document.getElementById('MsgBox').id = "MsgBoxOn";
			}
		}

		function CloseMsgBox() {
			//Self explanitory
			document.getElementById('MsgBoxOn').id = "MsgBox";
			document.getElementById('MsgBox').innerHTML = "";
			if ( msgQ[1] != undefined) {
				//If there's another message in the Q, open the Message Box with that one.
				msgBox(msgQ[1][0], msgQ[1][1]);
				msgQ.shift();
			}
		}

		function OpenSmallUIMenu() {
			document.getElementById('miniTOC').innerHTML = document.getElementById('TableOfContents').innerHTML;
			document.getElementById('SmallMenu').id = "SmallMenuOn";

		}

		function CloseSmallUIMenu() {
			if ( document.getElementById('SmallMenuOn') !== null ) {
				document.getElementById('SmallMenuOn').id = "SmallMenu";
			}

		}

		function scrollTOCTop() {
			document.getElementById('TableOfContents').scrollTo(0,0)
			document.getElementById('TableOfContentsCharList').scrollTo(0,0)
			if ( document.getElementById('SmallMenuOn') !== null ) {
				document.getElementById('SmallMenuOn').scrollTo(0,0);
			}
		}

		function updateLock() {
			if ( ponydata.MetaInf.lock == true) {
				document.getElementById('autosave_status').innerHTML = ".lockable { display: none;}";
			} else {
				document.getElementById('autosave_status').innerHTML = "";
			}

			if ( document.getElementById('MetaAuthorBox') != null ) {
				document.getElementById('MetaAuthorBox').disabled = ponydata.MetaInf.lock;
			}

		}

		function getSizeEstimate(arg) {
			var size = (JSON.stringify(arg).length);
			var suffix = "Bytes"

			if ( size > 1023) {
				//Divide to Kilobytes
				size = (size / 1024);
				suffix = "Kilobytes"
			}

			if  ( size > 1023) {
				//Divide to Megabytes
				size = (size / 1024);
				suffix = "Megabytes"
			}

			if  ( size > 1023) {
				//Divide to Gigabytes
				size = (size / 1024);
				suffix = "Gigabytes"
			}

			if ( size.toString().includes(".") ) {
				size = size.toString().substring(0, (size.toString().indexOf(".") + 2));
			}

			return size + " " + suffix;
		}

		function showPage(page) {
			//Show non-pony page
			if( page == "home" ) {
				viewing = "home";

				var tableContent = "<table class=ffwin><tr><td>Poniary<hr/>";
				tableContent = tableContent.concat("<center>Welcome To The Poniary OC Manager<br/><div id=MainLogo></div>");
				tableContent = tableContent.concat(poniaryVersion, "<br/><font size=1>by Christian \"Krissy\" Silvermoon</font><br/><br/>So... what is <i>Poniary?</i><br/>Poniary is an interactive tool to store details about characters you and maybe friends create. It was primarily created for storing MLP OCs, but can be used for others too. If you're like me an have like 50 characters, you probably like to document them to keep everything you do with them consistant!<br/><br/>Be careful not to refresh without saving!<br/>The page will try and catch you if you have unsaved changes, but that's not a guarantee!<br/><br/>Hopefully this Interactive OC Manager will help you keep track of your OCs as well as it does for me!<br/><br/>Happy Ponying!<br/><font size=0.5>(And yes, the UI Theme <b><i>is</b></i> Final Fantasy Inspired)</font></center>");
				tableContent = tableContent.concat("</td></tr></table>");

				document.getElementById("infocontainer").innerHTML = tableContent;
			} else if (page == "Contents") {
				//Contents Page
				viewing == "Contents";
				var tableContent = "<table class=ffwin><tr><td>Table Of Contents<hr/>";
				tableContent = tableContent.concat("<b><u>Information</b></u><br/>");
				tableContent = tableContent.concat("<a href=\"javascript:void(0)\" onclick=\"showPage('home'); CloseSmallUIMenu();\">Welcome Page</a><br/>");

				tableContent = tableContent.concat("<a href=\"javascript:void(0)\" onclick=\"showPage('help'); CloseSmallUIMenu();\">Help Document</a><br/>");
				tableContent = tableContent.concat("<a href=\"javascript:void(0)\" onclick=\"showPage('BBCodeRef'); CloseSmallUIMenu();\">BBCode Reference Guide</a><br/>");

				tableContent = tableContent.concat("<a href=\"javascript:void(0)\" onclick=\"showPage('license'); CloseSmallUIMenu();\">Software License</a><br/>");
				tableContent = tableContent.concat("<br/><b><u>Tools</b></u><br/>");
				tableContent = tableContent.concat("<a href=\"javascript:void(0)\" onclick=\"showPage('meta'); CloseSmallUIMenu();\">Meta Information Editor</a><br/>");
				tableContent = tableContent.concat("<a href=\"", bugReportURL, "\" target=\"_blank\">Report a Bug</a><br/>");
				tableContent = tableContent.concat("<a href=\"", featureRequestURL, "\" target=\"_blank\">Request a Feature</a>");


				tableContent = tableContent.concat("</td></tr></table>");

				document.getElementById("infocontainer").innerHTML = tableContent;
			} else if (page == "meta") {
				viewing = "meta";

				var tableContent = "<table class=ffwin><tr><td>Meta Information<hr/>";
				tableContent = tableContent.concat("Latest Poniary Save Version: " + poniarySaveVersion + "<br/><br/>")
				tableContent = tableContent.concat("Poniary Save Version: ", ponydata.MetaInf.version, "<br/>");
				tableContent = tableContent.concat("Estimated File Size: ", getSizeEstimate(ponydata), "<br/>");
				tableContent = tableContent.concat("Number of Characters: ", ponydata.TableOfContents.length, "<br/>");
				tableContent = tableContent.concat("Author Name: ", bbCodeDecode(ponydata.MetaInf.author), "<br/>");
				tableContent = tableContent.concat("Locked: ", ponydata.MetaInf.lock, "<br/>");
				tableContent = tableContent.concat("Pretty JSON: ", ponydata.MetaInf.pretty, "<br/><br/>");


				tableContent = tableContent.concat("<b><u>Changeable Settings</b></u><br/>");

				tableContent = tableContent.concat("Author: <input id=\"MetaAuthorBox\" type=text style=\"width: 90%;\" onchange=\"ponydata.MetaInf.author = this.value; showPage('meta')\" placeholder=\"Author\"></input><br/>");
				tableContent = tableContent.concat("<input type=checkbox onchange=\"ponydata.MetaInf.lock = this.checked; updateLock(); showPage('meta')\" ");
				if ( ponydata.MetaInf.lock == true) {
					tableContent = tableContent.concat("checked");
				}
				tableContent = tableContent.concat("></input>Locked (Prevents Changes)<br/>");
				tableContent = tableContent.concat("<input type=checkbox onchange=\"ponydata.MetaInf.pretty = this.checked; updateLock(); showPage('meta')\" ");
				if ( ponydata.MetaInf.pretty == true) {
					tableContent = tableContent.concat("checked");
				}
				tableContent = tableContent.concat("></input>Pretty JSON (Spaces in exported JSON Files)<br/>");

				tableContent = tableContent.concat("</td></tr></table>");

				document.getElementById("infocontainer").innerHTML = tableContent;
				document.getElementById("MetaAuthorBox").value = ponydata.MetaInf.author;
			} else if (page == "license") {
				viewing = "license";
				var tableContent = "<table class=ffwin><tr><td>The Unlicense<hr/>";

				tableContent = tableContent.concat("This is free and unencumbered software released into the public domain.<br/><br/>Anyone is free to copy, modify, publish, use, compile, sell, or distribute this software, either in source code form or as a compiled binary, for any purpose, commercial or non-commercial, and by any means.<br/><br/>In jurisdictions that recognize copyright laws, the author or authors of this software dedicate any and all copyright interest in the software to the public domain. We make this dedication for the benefit of the public at large and to the detriment of our heirs and successors. We intend this dedication to be an overt act of relinquishment in perpetuity of all present and future rights to this software under copyright law.<br/><br/><b>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</b><br/><br/><center>For more information, please refer to<br/><a href=http://unlicense.org/>http://unlicense.org/</a></center>");
				tableContent = tableContent.concat("</td></tr></table>");

				document.getElementById("infocontainer").innerHTML = tableContent;
			} else if (page == "help") {
				viewing = "help";
				var tableContent = document.getElementById("Page_Help").innerHTML;
				document.getElementById("infocontainer").innerHTML = tableContent;
			} else if ( page == "BBCodeRef") {
				viewing = "bbcoderef";
				var tableContent = document.getElementById("BBCode_Ref").innerHTML;
				document.getElementById("infocontainer").innerHTML = tableContent;
			}
			updateLock();

		}

		// function bbCodeEncode(string) {
		// 	//Encode valid HTML to BBCode. Cut invalid HTML tags out.
		//
		// 	//Italics
		// 	string = string.replace(/\<i\>/g,"[i]").replace(/\<\/i\>/g,"[/i]");
		// 	//Bold
		// 	string = string.replace(/\<b\>/g,"[b]").replace(/\<\/b\>/g,"[/b]");
		// 	//Underlined
		// 	string = string.replace(/\<u\>/g,"[u]").replace(/\<\/u\>/g,"[/u]");
		// 	//Strikethrough
		// 	string = string.replace(/\<s\>/g,"[s]").replace(/\<\/s\>/g,"[/s]");
		// 	//Subscript
		// 	string = string.replace(/\<sub\>/g,"[sub]").replace(/\<\/sub\>/g,"[/sub]");
		// 	//Superscript
		// 	string = string.replace(/\<sup\>/g,"[sup]").replace(/\<\/sup\>/g,"[/sup]");
		//
		// 	//Return with illegals removed.
		// 	return string.replace(/\<br\/\>/g,"\n").replace(/\</g,"").replace(/\>/g,"");
		// }

		function bbCodeDecode(string) {
			//Decode BBCODE to HTML

			//Replace < and > with &lt; and &gt;
			string = string.replace(/\</g,"&lt;").replace(/\>/g,"&gt;");

			//Italics
			string = string.replace(/\[i]((?:.|\t|\n|\r)*?)\[\/i\]/g, "<i>$1</i>");
			//Bold
			string = string.replace(/\[b]((?:.|\t|\n|\r)*?)\[\/b\]/g, "<b>$1</b>");
			//Underlined
			string = string.replace(/\[u]((?:.|\t|\n|\r)*?)\[\/u\]/g, "<u>$1</u>");
			//Strikethrough
			string = string.replace(/\[s]((?:.|\t|\n|\r)*?)\[\/s\]/g, "<s>$1</s>");
			//Subscript
			string = string.replace(/\[sub]((?:.|\t|\n|\r)*?)\[\/sub\]/g, "<sub>$1</sub>");
			//Superscript
			string = string.replace(/\[sup]((?:.|\t|\n|\r)*?)\[\/sup\]/g, "<sup>$1</sup>");
			//Colour
			string = string.replace(/\[colo(u|)r=((?:.|\t|\n|\r)*?)\]((?:.|\t|\n|\r)*?)\[\/colo(u|)r\]/g,"<font color=$2>$3</font>");
			//URLs
			string = string.replace(/\[url=((?:.|\t|\n|\r)*?)\]((?:.|\t|\n|\r)*?)\[\/url\]/g, "<a href=\"$1\" target=\"_blank\" title=\"Link to:&#10;$1\">$2</a>");
			string = string.replace(/\[url]((?:.|\t|\n|\r)*?)\[\/url\]/g, "<a href=\"$1\" target=\"_blank\" title=\"Link to:&#10;$1\">$1</a>");

			//Code
			string = string.replace(/\[code]((?:.|\t|\n|\r)*?)\[\/code\]/g, "<br/><div class=\"codeblock\"><code>$1</code></div><br/>");

			//Quotes
			string = string.replace(/\[quote]((?:.|\t|\n|\r)*?)\[\/quote\]/g, "<div class=\"blockquote\">$1</div>")
			string = string.replace(/\[quote=((?:.|\t|\n|\r)*?)]((?:.|\t|\n|\r)*?)\[\/quote\]/g, "<div class=\"blockquote\"><div class=\"quoteAuthor\">$1</div>$2</div>")

			//Special
			string = string.replace(/\[prisma]((?:.|\t|\n|\r)*?)\[\/prisma\]/g, "<span class=\"prisma\">$1</span>");
			string = string.replace(/\[spoiler]((?:.|\t|\n|\r)*?)\[\/spoiler\]/g, "<span class=\"spoiler\">$1</span>");
			string = string.replace(/\[highlight=((?:.|\t|\n|\r)*?)\]((?:.|\t|\n|\r)*?)\[\/highlight\]/g,"<span style=\"background: $1; padding: 2px; border-radius 6px;\">$2</span>");

			//Newlines
			string = string.replace(/\n/g,"<br/>");

			//Return String
			return string;
		}

		function bbCodeStrip(string, toStrip = [ "i", "b", "u", "s", "url", "namedURL", "sub", "sup", "spoiler", "quote", "authoredQuote", "color", "highlight", "prisma", "code"]) {
			//Strip BBCODE from text


			for ( var i = 0; i < toStrip.length; i++ ) {

				switch(toStrip[i]) {

					case "i":
						//Italics
						string = string.replace(/\[i]((?:.|\t|\n|\r)*?)\[\/i\]/g, "$1");
						break;
					case "b":
						//Bold
						string = string.replace(/\[b]((?:.|\t|\n|\r)*?)\[\/b\]/g, "$1");
						break;
					case "u":
						//Underlined
						string = string.replace(/\[u]((?:.|\t|\n|\r)*?)\[\/u\]/g, "$1");
						break;
					case "s":
						//Strikethrough
						string = string.replace(/\[s]((?:.|\t|\n|\r)*?)\[\/s\]/g, "$1");
						break;
					case "sub":
						//Subscript
						string = string.replace(/\[sub]((?:.|\t|\n|\r)*?)\[\/sub\]/g, "$1");
						break;
					case "sup":
						//Superscript
						string = string.replace(/\[sup]((?:.|\t|\n|\r)*?)\[\/sup\]/g, "$1");
						break;
					case "color":
						//Colour
						string = string.replace(/\[colo(u|)r=((?:.|\t|\n|\r)*?)\]((?:.|\t|\n|\r)*?)\[\/colo(u|)r\]/g,"$3");
						break;
					case "namedURL":
						//URLs
						string = string.replace(/\[url=((?:.|\t|\n|\r)*?)\]((?:.|\t|\n|\r)*?)\[\/url\]/g, "$2");
						break;
					case "url":
						string = string.replace(/\[url]((?:.|\t|\n|\r)*?)\[\/url\]/g, "$1");
						break;
					case "code":
						//Code
						string = string.replace(/\[code]((?:.|\t|\n|\r)*?)\[\/code\]/g, "$1");
						break;
					case "authoredQuote":
						//Quotes
						string = string.replace(/\[quote]((?:.|\t|\n|\r)*?)\[\/quote\]/g, "$1");
						break;
					case "quote":
						string = string.replace(/\[quote=((?:.|\t|\n|\r)*?)]((?:.|\t|\n|\r)*?)\[\/quote\]/g, "$2");
						break;
					case "prisma":
						//Special
						string = string.replace(/\[prisma]((?:.|\t|\n|\r)*?)\[\/prisma\]/g, "$1");
						break;
					case "spoiler":
						string = string.replace(/\[spoiler]((?:.|\t|\n|\r)*?)\[\/spoiler\]/g, "$1");
						break;
					case "highlight":
						string = string.replace(/\[highlight=((?:.|\t|\n|\r)*?)\]((?:.|\t|\n|\r)*?)\[\/highlight\]/g,"$2");
						break;
					default:
						console.warn("Invalid Parameters Given to BBCodeStrip!");
						break;
				}
			}

			//Return String
			return string;
		}

		function loadPon(pony) {
			//Set Page to clicked pony
			updateLock();
			console.log("Loading pon:", pony);
			viewing = pony;
			//background: linear-gradient(135deg,  #003F8C 0%,#000000 100%);
			var tableContent = "<tr><td style=\"background: linear-gradient(135deg, ";
			tableContent = tableContent.concat(ponydata.TableOfContents[pony].bkg); //Horse BKG Color
			tableContent = tableContent.concat(" 0%, #000000 100%)!important;\">");
			tableContent = tableContent.concat("<sup><font size=1 color=#26FF6A;>", (viewing + 1), "/", ponydata.TableOfContents.length, "</font></sup> " );
			tableContent = tableContent.concat(bbCodeDecode( bbCodeStrip(ponydata.TableOfContents[pony].name, [ "quote", "code", "authoredQuote"]) ) ); //Horse Name
			tableContent = tableContent.concat("<div style=\"float: right;\">" + bbCodeDecode( bbCodeStrip(ponydata.TableOfContents[pony].subtitle, [ "quote", "code", "authoredQuote"])) + "</div><hr/>"); //Subtitle
			//Horse Pictures
			if ( typeof ponydata.TableOfContents[pony].img[0] != "undefined" ){
				tableContent = tableContent.concat("<table style=\"border: none;\" border=\"1px\"><tr>");
				for(i = 0; ponydata.TableOfContents[pony].img[i] != undefined; i++) {
					tableContent = tableContent.concat("<td width=\"100px\" height=\"100px\"><img width=100px height=100px src=\"" + ponydata.TableOfContents[pony].img[i][1] + "\"></td>");
				}
				tableContent = tableContent.concat("</tr><tr>")
				for(i = 0; ponydata.TableOfContents[pony].img[i] != undefined; i++) {
					tableContent = tableContent.concat("<td><center>" + bbCodeDecode( bbCodeStrip(ponydata.TableOfContents[pony].img[i][0], [ "quote", "code", "authoredQuote"])) + "</center></td>");
				}
				tableContent = tableContent.concat("</table><br/>");
			}

			//Pon Maker
			if ( ponydata.TableOfContents[pony].creator.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].creator.length != 0) {
				tableContent = tableContent.concat("Creator: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].creator, [ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].creator.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Creator: <font color=gray><i>" + bbCodeDecode( bbCodeStrip(ponydata.TableOfContents[pony].creator, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			//Pon Day!
			if ( ponydata.TableOfContents[pony].dob.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].dob.length != 0 ) {
				tableContent = tableContent.concat("Birth Date: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].dob, [ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].dob.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Birth Date: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].dob, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			//Pon Home
			if ( ponydata.TableOfContents[pony].birth_place.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].birth_place.length != 0 ) {
				tableContent = tableContent.concat("Birth Place: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].birth_place, [ "quote", "code", "authoredQuote"])) + "<br/>");
			} else if ( ponydata.TableOfContents[pony].birth_place.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Birth Place: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].birth_place, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			//Pon Type
			if ( ponydata.TableOfContents[pony].race.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].race.length != 0 ) {
				tableContent = tableContent.concat("Race: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].race, [ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].race.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Race: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].race, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			//Girl Pon? Boy Pon? ~ Professor Oak
			if ( ponydata.TableOfContents[pony].gender.toLowerCase() != "undefined" && ponydata.TableOfContents[pony].gender != "N/a" ) {
				tableContent = tableContent.concat("Gender: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].gender, [ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].gender.toLowerCase() == "undefined" ) {
				tableContent = tableContent.concat("Gender: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].gender, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			//Pon likes what pons?
			if ( ponydata.TableOfContents[pony].orientation.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].orientation.length != 0 ) {
				tableContent = tableContent.concat("Orientation: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].orientation, [ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].orientation.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Orientation: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].orientation, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			//What does pon do?
			if ( ponydata.TableOfContents[pony].occupation.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].occupation.length != 0 ) {
				tableContent = tableContent.concat("Occupation: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].occupation, [ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].occupation.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Occupation: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].occupation, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			if ( ponydata.TableOfContents[pony].special_talent.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].special_talent.length != 0 ) {
				tableContent = tableContent.concat("Special Talent: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].special_talent, [ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].special_talent.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Special Talent: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].special_talent, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			//Magic Pon Mark
			if ( ponydata.TableOfContents[pony].cutie_mark.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].cutie_mark != 0 ) {
				tableContent = tableContent.concat("Cutie Mark: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].cutie_mark,[ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].cutie_mark.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Cutie Mark: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].cutie_mark, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}

			//Pon Universe
			if ( ponydata.TableOfContents[pony].universe.toLowerCase() != "unknown" && ponydata.TableOfContents[pony].universe != 0 ) {
				tableContent = tableContent.concat("Universe: " + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].universe, [ "quote", "code", "authoredQuote"])) + "<br/>");

			} else if ( ponydata.TableOfContents[pony].universe.toLowerCase() == "unknown" ) {
				tableContent = tableContent.concat("Universe: <font color=gray><i>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].universe, [ "quote", "code", "authoredQuote"])) + "</i></font><br/>");
			}


			/*Custom Fields*/
			for(i = 0; ponydata.TableOfContents[pony].customFields[i] != undefined; i++) {
				tableContent = tableContent.concat( bbCodeDecode(ponydata.TableOfContents[pony].customFields[i][0]), ": ", bbCodeDecode(ponydata.TableOfContents[pony].customFields[i][1]), "<br/>");
			}

			/*Pony Colors Table*/
			if ( ponydata.TableOfContents[pony].colors.length > 0 ) {
				tableContent = tableContent.concat("<br/>Coloration:<br/><table class=\"list_table\"><tr><td>Color</td><td>Item(s)</td></tr>");
				for(i = 0; ponydata.TableOfContents[pony].colors[i] != undefined; i++) {
					tableContent = tableContent.concat("<tr><td style=\"background: " + ponydata.TableOfContents[pony].colors[i][0] + ";\">" + ponydata.TableOfContents[pony].colors[i][0] + "</td><td>" + bbCodeDecode( bbCodeStrip(ponydata.TableOfContents[pony].colors[i][1], [ "quote", "code", "authoredQuote"])) + "</td></tr>" );
				}
				tableContent = tableContent.concat("</table><br/>");
			}

			/*Family Table*/
			if ( ponydata.TableOfContents[pony].family.length > 0 ) {
				tableContent = tableContent.concat("Family:<br/><table class=\"list_table\"><tr><td>Relation</td><td>Name</td></tr>");
				for(i = 0; ponydata.TableOfContents[pony].family[i] != undefined; i++) {
					tableContent = tableContent.concat("<tr><td>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].family[i][0], [ "quote", "code", "authoredQuote"])) + "</td><td>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].family[i][1], [ "quote", "code", "authoredQuote"])) + "</td></tr>" );
				}
				tableContent = tableContent.concat("</table><br/>");
			}

			//Bio
			if ( ponydata.TableOfContents[pony].bio.length > 0 ) {
				tableContent = tableContent.concat("Description:<br/><div class=\"indent presize\">" + bbCodeDecode(ponydata.TableOfContents[pony].bio) + "</div>");
			}

			/*Abillity Table*/
			if ( ponydata.TableOfContents[pony].abilities.length > 0) {
				tableContent = tableContent.concat("<br/>Abilities:<br/><table class=\"list_table max_width\"><tr><td>Type</td><td>Subtype</td><td>Name</td><td>Description</td></tr>");
				for(i = 0; ponydata.TableOfContents[pony].abilities[i] != undefined; i++) {
					tableContent = tableContent.concat("<tr><td>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].abilities[i][0],[ "quote", "code", "authoredQuote"])) + "</td><td>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].abilities[i][1], [ "quote", "code", "authoredQuote"])) + "</td><td>" + bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[pony].abilities[i][2], [ "quote", "code", "authoredQuote"])) + "</td><td>" + bbCodeDecode(ponydata.TableOfContents[pony].abilities[i][3]) + "</td></tr>" );
				}
				tableContent = tableContent.concat("</table><br/>");
			}


			tableContent = tableContent.concat("</tr></td>"); //End Pon Deeets

			document.getElementById("infocontainer").innerHTML = tableContent;
		}

		function setStage() {
			//Init Table of Contents, loading from ponydata, set page to Home
			var tocdata = "<table class=goldwin><tr><td>Characters <span style=\"float: right;\">(<span class=\"lockable\"><a href=\"javascript:void(0)\" title=\"Add New Character\" onclick=\"newBtnClick()\">+</a>/</span><a href=\"javascript:void(0)\" title=\"Character Options\" onclick=\"ponyContextMenu()\">?</a>/<a href=\"javascript:void(0)\" title=\"Character Context Menu\" onclick=\"TocMenu()\">M</a>)</span></td></tr></table>";

			if ( ponydata.TableOfContents.length > 0) {
				tocdata = tocdata.concat("<div class=vOverflowScroll id=TableOfContentsCharList><table class=ffwin width=100%><tr><td>");
				for( i = 0; ponydata.TableOfContents[i] !== undefined; i++ ) {
					tocdata = tocdata.concat("<a title=\"Position: ", (i + 1), "/", ponydata.TableOfContents.length, "&#10;", "Subtitle: ", bbCodeStrip(ponydata.TableOfContents[i].subtitle), "&#10;Estimated Size: ", getSizeEstimate(ponydata.TableOfContents[i]) ,"\" href=\"javascript:void(0)\" onclick=\"loadPon(", i, "); CloseSmallUIMenu();\" oncontextmenu=\"loadPon(", i, "); ponyContextMenu(); return false;\" style=\"border-left: 2px solid ", ponydata.TableOfContents[i].bkg, ";\">" , bbCodeDecode(bbCodeStrip(ponydata.TableOfContents[i].name, ["code", "quote", "authoredQuote", "url", "namedURL"])), "</a><br/>");
				}

				tocdata = tocdata.concat("</td></td></table></div><table><tr><td class=\"goldwin\"><a href=\"javascript:void(0)\" onclick=\"scrollTOCTop()\">Back To Top</a></td>");
				tocdata = tocdata.concat("</tr></table>");
			}

			document.getElementById("TableOfContents").innerHTML = tocdata;
			document.getElementById("miniTOC").innerHTML = tocdata;
			showPage("home");
			updateLock();
		}

		document.onkeydown = function(event) {
			/*Key Listener*/
			/*Escape Key, close any UI windows*/
			//console.log(event.key, " | ", event.keyCode)
			if( (event.key == "Escape" || event.keyCode === 27) && (document.getElementById('SaveBoxOn') != null) ) {
				CloseSaveBox();
			}
			if( (event.key == "Escape" || event.keyCode === 27) && (document.getElementById('LoadBoxOn') != null) ) {
				CloseLoadBox();
			}
			if( (event.key == "Escape" || event.keyCode === 27) && (document.getElementById('MsgBoxOn') != null) ) {
				CloseMsgBox();
			}
			if ( (event.key == "Escape" || event.keyCode === 27) && (document.getElementById('SmallMenuOn')) ) {
				CloseSmallUIMenu();
			}
			if( (event.key == "Escape" || event.keyCode === 27) && (document.getElementById('editorOn') != null) ) {
				editorSav('cancel');
			}
			if ( (event.key == "Escape" || event.keyCode === 27) && (document.getElementById('PonyContextMenuOn')) ) {
				document.getElementById('PonyContextMenuOn').id = 'PonyContextMenu'
			}

			if ( (document.getElementById('editorOn') == null) && (document.getElementById('MsgBoxOn') == null) && (document.getElementById('PonyContextMenuOn') == null) && (document.getElementById('SaveBoxOn') == null) && (document.getElementById('LoadBoxOn') == null) ) {

				if ( (event.key == ">" || event.key == ".") && (typeof viewing == "number" ) && ( viewing < ponydata.TableOfContents.length) ) {
					loadPon(viewing + 1);
				}

				if ( (event.key == "<" || event.key == "," ) && (typeof viewing == "number" ) && ( viewing > 0) ) {
					loadPon(viewing - 1);
				}

				if ( (event.key == "?") && (typeof viewing == "number" )) {
					ponyContextMenu();
				}

				if ( (event.key == "m" || event.key == "M") && (typeof viewing == "number" )) {
					TocMenu();
				}

				if ( (event.key == "+") && (typeof viewing == "number" )) {
					if ( ponydata.MetaInf.lock == false) {
						newBtnClick();
					} else {
						msgBox("You need to unlock your Poniary Save before you can preform this action!", "Locked!");
					}
				}
			}
		}

		window.onbeforeunload = function(event) {
			if ( JSON.stringify(ponydata) != JSON.stringify(origponydata) ) {
				return "Are you sure you wanna leave? You'll lose any unsaved changes!"
			} else {
				return;
			}
		}

		function rand(min, max) {
    		return Math.floor(Math.random() * (max - min + 1) + min)
		}

		function dice(dice) {
		    total = 0;
		    if ( dice.toString().indexOf('d') != -1 ) {
		        //Rolling Something d Something
		        for ( i = 0; i < dice.split('d')[0]; i++ ) {
		            total = total + rand( 1, dice.split('d')[1] );
		        }
		    } else {
		        //Just a static number
		        total = rand( 1, dice)
		    }
		    return total;
		}

		function ponSaveUpdater(obj) {
			switch(obj.MetaInf.version) {
				case "18.2.2":
					console.info("Save Version is Old (18.2.2/Original)");
					obj.MetaInf.pretty = false;
					obj.MetaInf.version = poniarySaveVersion;
					msgBox(`Save version updated<br/>18.2.2 <b><font color=#26FF6A>→</font></b> ${poniarySaveVersion}`, "Save Updater");
					break;
				case poniarySaveVersion:
					console.info("Save Version is Up To Date");
					break;
				default:
					msgBox(`<b><font color=red>WARNING</b></font><br/>Save Version \"<u><span style=\"background: black; padding: 1px; border-radius: 6px;\">${obj.MetaInf.version}</span></u>\" is unknown!<br/>Loading newer saves in older versions can result in data loss!<br/><b><u>Continue at your own risk</u></b>`, "Save Updater");
					console.error("SAVE VERSION IS NEW!");
					break;
			}

			return obj;

		}

		function undoLoadFile(mode = "prompt") {
			if ( mode == "prompt" ) {
				msgBox("Revert Changes to before the last file load?<br/><br/><span onclick=\"undoLoadFile('confirm'); CloseMsgBox()\"><a href=\"javascript:void(0)\">Restore</a></span>", "Restore Previous File")
			} else if (mode == "confirm") {
				ponydata = JSON.parse(JSON.stringify(undoLoad));
				msgBox("Reverted changes to before last File Load.", "File Restored");
				undoLoad = {};
				showPage('home');
				updateLock();
				setStage();
				CloseLoadBox();
			}
		}

		//Initialization
		var poniarySaveVersion = "18.4.27";
		var poniaryVersion = "The Ponies & Palaces Update (WIP)"

		//Default Pony Data
		var defaultPonydata = {
			MetaInf:{
				"version": poniarySaveVersion,
				"app":"Poniary OC Manager",
				"author":"unknown",
				"lock":false,
				"pretty": false
			},
			TableOfContents:[]
		};
		//
		// RaceIcons: {
		// 	Default: {
		// 		icon: "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8%2F9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz%0AAAAOxAAADsQBlSsOGwAAAL1JREFUOI3Nk7sNwzAMRO8S9wJcuHavJTyaMoo34RIuVXoATcA0liLI%0A9CdIk6sEkvdIAiJhSw%2FivAooAKjafrKUl0dXm7NxWRZ7rC1PUjOk%2B%2BS0GJ1zJiDnVbVAHm3Rkfko%0Ax7r7mblWSgnee5DEboJv9TPgCSCQxDAM6Pv%2BlmldV8zzDBH5kxVeIhLGcYRz7nKNGCNEBCEEwPoH%0AMcZTc6v6FnSjYpomEyAiAFC6twBgO6YMalXF91dlgQzt6t%2FiWkpzPMvIzgAAAABJRU5ErkJggg%3D%3D%0A",
		// 		regexp: "."
		// 	}
		// }

		var ponydata = JSON.parse(JSON.stringify(defaultPonydata));

		ponydata.MetaInf.version = poniarySaveVersion;

		var loadedPonyData = {};
		var undoLoad = {};
		var origponydata = JSON.parse(JSON.stringify(ponydata));
		var viewing = "home";

		function loadFile() {
			console.log("File Load Triggered...")
			var mode = "0";
			for ( i = 0; document.getElementById("LoadFileMode")[i].checked != true; i++) {
				mode++
			}

			console.log("File Load Mode:", mode);

			if ( mode == 0) {
				mode = "Prepend";
			} else if (mode == 1) {
				mode = "Overwrite";
			} else if (mode == 2 ) {
				mode = "Append";
			} else {
				mode = "Overwrite"
				console.error("Invalid FileLoadMode... defaulting to \"Overwrite\"");
			}

			console.log("File Load Mode:", mode);

			var file = document.getElementById('LoadFileBox').files[0];
			var reader = new FileReader();
			reader.onload = function(event) {
				undoLoad = JSON.parse(JSON.stringify(ponydata));
				if ( mode == "Overwrite") {
					ponydata = ponSaveUpdater(JSON.parse(event.target.result))
					origponydata = JSON.parse(event.target.result);
					var ponecounter = ponydata.TableOfContents.length;
					updateLock();

				} else if ( mode == "Append" ) {
					var lastempty = ponydata.TableOfContents.length;
					var loadedPoneData = ponSaveUpdater(JSON.parse(event.target.result));
					var ponecounter = loadedPoneData.TableOfContents.length; //Count # of pones loaded

					for(i = 0; i < loadedPoneData.TableOfContents.length; i++) {
						console.log("Loaded Ponies Iteration:", i)
						ponydata.TableOfContents[lastempty] = loadedPoneData.TableOfContents[i];
						console.log(loadedPoneData.TableOfContents[i]);
						lastempty++;
					}

				} else if ( mode == "Prepend" ) {
					var loadedPoneData = ponSaveUpdater(JSON.parse(event.target.result));
					var lastempty = loadedPoneData.TableOfContents.length;
					var ponecounter = loadedPoneData.TableOfContents.length; //Count # of pones loaded
					for(i = 0; i < ponydata.TableOfContents.length; i++) {
						loadedPoneData.TableOfContents[lastempty] = ponydata.TableOfContents[i];
						lastempty++;
					}
				}
				console.log(ponydata);
				CloseLoadBox();
				setStage();
				msgBox(`Loaded <font color=#33FF99>${ponecounter}</font> characters.`,"Load Complete");
			};
			reader.readAsText(file);
		}

		setStage();
		showPage("home");

	</script>
	<table class="top-button ffwin BigUI">
		<tr>
			<td class="goldwin"><a href="javascript:void(0)" onclick="window.scrollTo(0,0)">Back To Top</a></td>
		</tr>
	</table>
</body>
</html>
